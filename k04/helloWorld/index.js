/**
 * RPA im DTP essential |Â Beispiel-Plug-in: HelloWorld
 *
 * @summary Adobe Photoshop UXP Plug-in zur Generierung eines Dokuments mit einem "HelloWorld"-Textrahmen
 * @author Ennis Gundogan <e@gndgn.dev>
 */

const { entrypoints } = require("uxp");

entrypoints.setup({
   commands: {
      helloWorld: () => helloWorld()
   }
});

async function helloWorld() {

   const ps = require("photoshop");

   let doc = await ps.app.createDocument({
      height: 1600, 
      width: 2560, 
      resolution: 72, 
      mode: "RGB", 
      name: "Hello world!", 
      fill: "white"
   });

   ps.action.batchPlay([
      {"_obj":"make","_target":[{"_ref":"textLayer"}],"layerID":3,"using":{"_obj":"textLayer","antiAlias":{"_enum":"antiAliasType","_value":"antiAliasSharp"},"boundingBox":{"_obj":"boundingBox","bottom":{"_unit":"pointsUnit","_value":360.0894775390625},"left":{"_unit":"pointsUnit","_value":105.0625},"right":{"_unit":"pointsUnit","_value":2459.9375},"top":{"_unit":"pointsUnit","_value":0.0582275390625}},"bounds":{"_obj":"bounds","bottom":{"_unit":"pointsUnit","_value":663.8823852539063},"left":{"_unit":"pointsUnit","_value":0.0},"right":{"_unit":"pointsUnit","_value":2560.0},"top":{"_unit":"pointsUnit","_value":-63.507080078125}},"kerningRange":[],"orientation":{"_enum":"orientation","_value":"horizontal"},"paragraphStyleRange":[{"_obj":"paragraphStyleRange","from":0,"paragraphStyle":{"_obj":"paragraphStyle","align":{"_enum":"alignmentType","_value":"center"},"burasagari":{"_enum":"burasagari","_value":"burasagariStandard"},"directionType":{"_enum":"directionType","_value":"dirLeftToRight"},"hyphenate":true,"impliedSpaceAfter":{"_unit":"pointsUnit","_value":0.25343993306159975},"spaceAfter":{"_unit":"pointsUnit","_value":0.25343993306159975},"styleSheetHasParent":true,"textComposerEngine":{"_enum":"textComposerEngine","_value":"textOptycaComposer"},"textEveryLineComposer":true},"to":11}],"textClickPoint":{"_obj":"paint","horizontal":{"_unit":"percentUnit","_value":0.0},"vertical":{"_unit":"percentUnit","_value":29.478092783505156}},"textGridding":{"_enum":"textGridding","_value":"none"},"textKey":"HelloWorld","textShape":[{"_obj":"textShape","bounds":{"_obj":"rectangle","bottom":663.8823852539063,"left":0.0,"right":2560.0,"top":0.0},"char":{"_enum":"char","_value":"box"},"columnCount":1,"columnGutter":{"_unit":"pointsUnit","_value":0.0},"firstBaselineMinimum":{"_unit":"pointsUnit","_value":0.0},"frameBaselineAlignment":{"_enum":"frameBaselineAlignment","_value":"alignByAscent"},"orientation":{"_enum":"orientation","_value":"horizontal"},"rowCount":1,"rowGutter":{"_unit":"pointsUnit","_value":0.0},"rowMajorOrder":true,"spacing":{"_unit":"pointsUnit","_value":0.0},"transform":{"_obj":"transform","tx":0.0,"ty":0.0,"xx":1.0,"xy":0.0,"yx":0.0,"yy":1.0}}],"textStyleRange":[{"_obj":"textStyleRange","from":0,"textStyle":{"_obj":"textStyle","altligature":false,"autoLeading":true,"baseParentStyle":{"_obj":"textStyle","alternateLigatures":false,"altligature":false,"autoKern":{"_enum":"autoKern","_value":"metricsKern"},"autoLeading":true,"baseline":{"_enum":"baseline","_value":"normal"},"baselineDirection":{"_enum":"baselineDirection","_value":"rotated"},"baselineShift":{"_unit":"pointsUnit","_value":0.0},"characterRotation":0.0,"color":{"_obj":"RGBColor","blue":0.0,"grain":0.0,"red":0.0},"connectionForms":false,"contextualLigatures":false,"diacVPos":{"_enum":"diacVPos","_value":"diacVPosOpenType"},"diacXOffset":{"_unit":"pointsUnit","_value":0.0},"diacYOffset":{"_unit":"pointsUnit","_value":0.0},"digitSet":{"_enum":"digitSet","_value":"defaultDigits"},"dirOverride":{"_enum":"dirOverride","_value":"dirOverrideDefault"},"enableWariChu":false,"figureStyle":{"_enum":"figureStyle","_value":"normal"},"fill":true,"fillFirst":true,"fillOverPrint":false,"fontAvailable":true,"fontCaps":{"_enum":"fontCaps","_value":"normal"},"fontName":"Myriad Pro","fontPostScriptName":"MyriadPro-Regular","fontScript":0,"fontStyleName":"Regular","fontTechnology":0,"fractions":false,"gridAlignment":{"_enum":"gridAlignment","_value":"roman"},"horizontalScale":100.0,"impliedBaselineShift":{"_unit":"pointsUnit","_value":0.0},"impliedFontSize":{"_unit":"pointsUnit","_value":12.0},"italics":false,"japaneseAlternate":{"_enum":"japaneseAlternate","_value":"defaultForm"},"jiDori":0,"justificationAlternates":false,"kana":false,"kashidas":{"_enum":"kashidas","_value":"kashidaDefault"},"leftAki":-1.0,"ligature":true,"lineCap":{"_enum":"lineCap","_value":"buttCap"},"lineDashoffset":0.0,"lineJoin":{"_enum":"lineJoin","_value":"miterJoin"},"lineWidth":{"_unit":"pointsUnit","_value":1.0},"markYDistFromBaseline":{"_unit":"pointsUnit","_value":100.0},"miterLimit":{"_unit":"pointsUnit","_value":4.0},"mojiZume":0.0,"noBreak":false,"oldStyle":false,"ordinals":false,"ornaments":false,"otbaseline":{"_enum":"otbaseline","_value":"normal"},"proportionalMetrics":false,"rightAki":-1.0,"ruby":false,"size":{"_unit":"pointsUnit","_value":12.0},"strikethrough":{"_enum":"strikethrough","_value":"strikethroughOff"},"stroke":false,"strokeColor":{"_obj":"RGBColor","blue":0.0,"grain":0.0,"red":0.0},"strokeOverPrint":false,"stylisticAlternates":false,"stylisticSets":0,"swash":false,"syntheticBold":false,"syntheticItalic":false,"tcyLeftRight":0,"tcyUpDown":0,"textLanguage":{"_enum":"textLanguage","_value":"englishLanguage"},"titling":false,"tracking":0,"underline":{"_enum":"underline","_value":"underlineOff"},"underlineOffset":{"_unit":"pointsUnit","_value":0.0},"verticalScale":100.0,"wariChuCount":2,"wariChuJustification":{"_enum":"wariChuJustification","_value":"wariChuAutoJustify"},"wariChuLineGap":0,"wariChuOrphan":2,"wariChuScale":0.5,"wariChuWidow":2},"baseline":{"_enum":"baseline","_value":"normal"},"baselineDirection":{"_enum":"baselineDirection","_value":"withStream"},"baselineShift":{"_unit":"pointsUnit","_value":0.0},"color":{"_obj":"RGBColor","blue":0.0,"grain":0.0,"red":0.0},"connectionForms":false,"contextualLigatures":true,"diacXOffset":{"_unit":"pointsUnit","_value":0.0},"diacYOffset":{"_unit":"pointsUnit","_value":0.0},"digitSet":{"_enum":"digitSet","_value":"defaultDigits"},"figureStyle":{"_enum":"figureStyle","_value":"normal"},"fontAvailable":true,"fontCaps":{"_enum":"fontCaps","_value":"normal"},"fontName":"Myriad Pro","fontPostScriptName":"MyriadPro-Bold","fontScript":0,"fontStyleName":"Bold","fontTechnology":0,"fractions":false,"gridAlignment":{"_enum":"gridAlignment","_value":"roman"},"horizontalScale":100.0,"impliedBaselineShift":{"_unit":"pointsUnit","_value":0.0},"impliedFontSize":{"_unit":"pointsUnit","_value":500.0},"italics":false,"japaneseAlternate":{"_enum":"japaneseAlternate","_value":"defaultForm"},"justificationAlternates":false,"kana":false,"kashidas":{"_enum":"kashidas","_value":"kashidaDefault"},"ligature":true,"markYDistFromBaseline":{"_unit":"pointsUnit","_value":24.0},"mojiZume":0.0,"noBreak":false,"ordinals":false,"ornaments":false,"otbaseline":{"_enum":"otbaseline","_value":"normal"},"proportionalMetrics":false,"size":{"_unit":"pointsUnit","_value":500.0},"strikethrough":{"_enum":"strikethrough","_value":"strikethroughOff"},"strokeColor":{"_obj":"RGBColor","blue":239.99610990285874,"grain":239.99610990285874,"red":239.99610990285874},"styleSheetHasParent":true,"stylisticAlternates":false,"stylisticSets":0,"swash":false,"syntheticBold":false,"syntheticItalic":false,"textLanguage":{"_enum":"textLanguage","_value":"englishLanguage"},"titling":false,"tracking":-20,"underline":{"_enum":"underline","_value":"underlineOff"},"verticalScale":100.0},"to":11}],"warp":{"_obj":"warp","warpPerspective":0.0,"warpPerspectiveOther":0.0,"warpRotate":{"_enum":"orientation","_value":"horizontal"},"warpStyle":{"_enum":"warpStyle","_value":"warpNone"},"warpValue":0.0}}}
      ], { synchronousExecution: true});

}